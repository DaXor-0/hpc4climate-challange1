! grid_nml: horizontal grid --------------------------------------------------
&grid_nml
 dynamics_grid_filename      =       'iconR3B08_DOM01.nc'         ! array of the grid filenames for the dycore
 radiation_grid_filename     =       'iconR3B07_DOM00.nc'         ! array of the grid filenames for the radiation model
 lredgrid_phys               =               .TRUE.,.TRUE.        ! .true.=radiation is calculated on a reduced grid
 lfeedback                   =                      .TRUE.        ! specifies if feedback to parent grid is performed
 ifeedback_type              =                          2         ! feedback type (incremental/relaxation-based)
 l_limited_area              =                      .TRUE.        ! limited area run TRUE/FALSE
/

! initicon_nml: specify read-in of initial state ------------------------------
&initicon_nml
 init_mode                  =                  7                 ! start from DWD initialized analysis
 dwdfg_filename             =                  'init_ML_20210714T000000Z.nc'        ! initialized analysis data input filename
 lread_ana                  =                  .FALSE.        ! Read separate analysis file in addition to dwdfg_filename
 ltile_coldstart            =                       .TRUE.       ! coldstart for surface tiles
 ltile_init                 =                      .FALSE.       !
 lp2cintp_sfcana            =                       .TRUE.       ! interpolate surface analysis from global domain onto nest
 ana_varnames_map_file      =   'ana_varnames_map_file.txt'      ! dictionary mapping internal names onto GRIB2 or NetCDF shortNames
/

&limarea_nml
 dtime_latbc                 =                      7200.        ! Time difference between two consecutive boundary data
 init_latbc_from_fg          =                     .TRUE.        ! If .TRUE., take lateral boundary conditions for initial time from FG
 itype_latbc                 =                         1         ! Type of lateral boundary nudging
 latbc_boundary_grid         =                         ''        ! Grid file defining the lateral boundary
 latbc_varnames_map_file     =           'map_file.latbc'        ! dictionary mapping internal names onto GRIB2 or NetCDF shortNames
 latbc_path                  =                       './'        ! path to boundary data
 latbc_filename              =            'forcing_ML_<y><m><d>T<h>0000Z_lbc.nc'        ! Filename of boundary data input file in the latbc_path directory.
/
! parallel_nml: MPI parallelization -------------------------------------------
&parallel_nml
 nproma                      =                         32         ! loop chunk length
 p_test_run                  =                     .FALSE.        ! .TRUE. means verification run for MPI parallelization
 num_io_procs                =                          1         ! number of I/O processors
 num_restart_procs           =                          0         ! number of restart processors
 num_prefetch_proc           =                          1         ! number of processors for boundary data prefetching
 iorder_sendrecv             =                          3         ! sequence of MPI send/receive calls
 num_dist_array_replicas     =                          4         ! distributed arrays: no. of replications
 use_omp_input               =                      .TRUE.        ! allows task parallelism for reading atmospheric input data
/

! io_nml: general switches for model I/O -------------------------------------
&io_nml
 dt_diag                     =                      21600.0       ! diagnostic integral output interval
 dt_checkpoint               =                     864000.0       ! time interval for writing restart files.
 itype_pres_msl              =                          5         ! method for computation of mean sea level pressure
 itype_rh                    =                          1         ! (1) 2: mixed phase (water and ice)
 output_nml_dict             =                 'dict.output.dwd'  ! maps output_nml variable names onto internal ICON names
 lflux_avg                   =                      .TRUE.        ! fluxes are accumulated rather than averaged for output
 lmask_boundary              =                      .TRUE.        ! mask interpolation zone
 precip_interval             =                      'PT01H'
/

! run_nml: general switches ---------------------------------------------------
&run_nml
 num_lev                     =                         65         ! number of full levels (atm.) for each domain
 lvert_nest                  =                      .FALSE.       ! vertical nesting
 dtime                       =                         60.        ! timestep in seconds
 ltestcase                   =                    .FALSE.         ! idealized testcase runs
 ldynamics                   =                      .TRUE.        ! compute adiabatic dynamic tendencies
 ltransport                  =                      .TRUE.        ! compute large-scale tracer transport
 lart                        =                     .FALSE.        ! ICON-ART main switch
 ntracer                     =                          5         ! number of advected tracers
 iforcing                    =                          3         ! forcing of dynamics and transport by parameterized processes
 msg_level                   =                         11         ! controls how much printout is written during runtime
 ltimer                      =                      .TRUE.        ! timer for monitoring the runtime of specific routines
 timers_level                =                         10         ! performance timer granularity
 output                      =                       "nml"        ! main switch for enabling/disabling components of the model output
/

! nwp_phy_nml: switches for the physics schemes ------------------------------
&nwp_phy_nml
 inwp_gscp                   =                          2         ! cloud microphysics (incl. graupel) and precipitation
 inwp_convection             =                          1         ! convection
 lshallowconv_only           =                     .FALSE.        !
 lgrayzone_deepconv          =                      .TRUE.        !
 inwp_radiation              =                          4         ! radiation
 inwp_cldcover               =                          1         ! cloud cover scheme for radiation
 inwp_turb                   =                          1         ! vertical diffusion and transfer
 inwp_satad                  =                          1         ! saturation adjustment
 inwp_sso                    =                          1         ! subgrid scale orographic drag
 inwp_gwd                    =                          0         ! non-orographic gravity wave drag
 inwp_surface                =                          1         ! surface scheme
 latm_above_top              =                      .TRUE.        ! take into account atmosphere above model top for radiation computation
 ldetrain_conv_prec          =                      .TRUE.        !
 efdt_min_raylfric           =                       7200.0       ! minimum e-folding time of Rayleigh friction
 itype_z0                    =                          2         ! type of roughness length data
 icapdcycl                   =                          3         ! apply CAPE modification to improve diurnalcycle over tropical land
 icpl_aero_conv              =                          1         ! coupling between autoconversion and Tegen aerosol climatology
 icpl_aero_gscp              =                          1         ! coupling between autoconversion and Tegen aerosol climatology
 icpl_o3_tp                  =                          1         ! coupling between ozone mixing ratio and thermal tropopause
 dt_rad                      =                         720        ! time step for radiation in s
 dt_conv                     =                         120        ! time step for convection in s (domain specific)
 dt_sso                      =                         120        ! time step for SSO parameterization
 dt_gwd                      =                         120        ! time step for gravity wave drag parameterization
 mu_rain                     =                          0.5       ! shape parameter in gamma distribution for rain
 rain_n0_factor              =                          0.1       ! tuning factor for intercept parameter of raindrop size distr.
/

&nwp_tuning_nml
 itune_albedo                =                          1
 tune_box_liq_asy            =                          4.0
 tune_gfrcrit                =                          0.333
 tune_gkdrag                 =                          0.125
 tune_gkwake                 =                          0.25
 tune_gust_factor            =                          7.0
 itune_gust_diag             =                          3
 tune_gustsso_lim            =                          20.
 tune_minsnowfrac            =                          0.3
 tune_sgsclifac              =                          1.0
 tune_rcucov                 =                          0.075
 tune_rhebc_land             =                          0.825
 tune_zvz0i                  =                          0.85
 icpl_turb_clc               =                          2
 max_calibfac_clcl           =                          2.0
 tune_box_liq                =                          0.04
 tune_eiscrit                =                          7.
/

! turbdiff_nml: turbulent diffusion -------------------------------------------
&turbdiff_nml
 tkhmin                      =                          0.5       ! scaling factor for minimum vertical diffusion coefficient
 tkhmin_strat                =                          0.75      ! Scaling factor for stratospheric minimum vertical diffusion coefficient
 tkmmin                      =                          0.75      ! scaling factor for minimum vertical diffusion coefficient
 tkmmin_strat                =                          4.0       ! Scaling factor for stratospheric minimum vertical diffusion coefficient
 tur_len                     =                          300.      ! Asymptotic maximal turbulent distance
 pat_len                     =                        750.0       ! effective length scale of thermal surface patterns
 q_crit                      =                          2.0       ! critical value for normalized super-saturation 
 rat_sea                     =                          0.8       ! controls laminar resistance for sea surface
 ltkesso                     =                        .TRUE.      ! consider TKE-production by sub-grid SSO wakes
 frcsmot                     =                          0.2       ! these 2 switches together apply vertical smoothing of the TKE source terms
 imode_frcsmot               =                            2       ! in the tropics (only), which reduces the moist bias in the tropical lower troposphere
 imode_tkesso                =                            2       ! mod of calculating the SSO source term for TKE production
 itype_sher                  =                            2       ! type of shear forcing used in turbulence
 ltkeshs                     =                        .TRUE.      ! include correction term for coarse grids in hor. shear production term
 a_hshr                      =                          1.25      ! length scale factor for separated horizontal shear mode
 alpha1                      =                          0.125     ! Scaling parameter for molecular roughness of ocean waves
 icldm_turb                  =                            2       ! mode of cloud water representation in turbulence
 rlam_heat                   =                         10.0       ! Scaling factor of the laminar boundary layer for heat
/

! lnd_nml: land scheme switches -----------------------------------------------
&lnd_nml
 ntiles                      =                          3         ! number of tiles
 nlev_snow                   =                          3         ! number of snow layers
 lmulti_snow                 =                      .FALSE.       ! .TRUE. for use of multi-layer snow model
 idiag_snowfrac              =                         20         ! type of snow-fraction diagnosis
 lsnowtile                   =                       .TRUE.       ! .TRUE.=consider snow-covered and snow-free separately
 itype_canopy                =                          2         ! Type of canopy parameterization
 itype_root                  =                          2         ! root density distribution
 itype_trvg                  =                          3         ! BATS scheme with add. prog. var. for integrated plant transpiration since sunrise
 itype_evsl                  =                          4         ! type of bare soil evaporation
 itype_heatcond              =                          3         ! type of soil heat conductivity
 itype_lndtbl                =                          4         ! table for associating surface parameters
 itype_snowevap              =                          3         ! Snow evap. in vegetated areas with add. variables for snow age and max. snow height
 cwimax_ml                   =                          5.e-4     ! scaling parameter for maximum interception parameterization
 c_soil                      =                          1.25      ! surface area density of the (evaporative) soil surface
 c_soil_urb                  =                          0.5       ! surface area density of the (evaporative) soil surface, urban areas
 lseaice                     =                      .TRUE.        ! .TRUE. for use of sea-ice model
 llake                       =                      .TRUE.        ! .TRUE. for use of lake model
 lprog_albsi                 =                      .TRUE.        ! sea-ice albedo is computed prognostically
 sstice_mode                 =                          2         ! SST is updated by climatological increments on a daily basis
/

! radiation_nml: radiation scheme ---------------------------------------------
&radiation_nml
 irad_o3                     =                         79         ! ozone climatology
 irad_aero                   =                          6         ! aerosols
 islope_rad                  =                          0         ! slope correction for surface radiation
 albedo_type                 =                          2         ! type of surface albedo
 albedo_whitecap             =                          1         ! Ocean albedo increase by foam
 direct_albedo_water         =                          3         ! Direct beam surface albedo over water
 vmr_co2                     =                    425.e-06        ! values representative for 2023
 vmr_ch4                     =                   1900.e-09
 vmr_n2o                     =                   334.0e-09
 vmr_o2                      =                     0.20946
 vmr_cfc11                   =                    220.e-12
 vmr_cfc12                   =                    490.e-12
 ecrad_data_path             =                  "/work/bk1414/summerschool/icon/externals/ecrad/data"   ! Path to folder containing ecRad optical property files
/

! nonhydrostatic_nml: nonhydrostatic model -----------------------------------
&nonhydrostatic_nml
 iadv_rhotheta               =                          2         ! advection method for rho and rhotheta
 ivctype                     =                          2         ! type of vertical coordinate
 itime_scheme                =                          4         ! time integration scheme
 ndyn_substeps               =                          5         ! number of dynamics steps per fast-physics step
 exner_expol                 =                          0.333     ! temporal extrapolation of Exner function
 vwind_offctr                =                          0.2       ! off-centering in vertical wind solver
 damp_height                 =                       12250.       ! height at which Rayleigh damping of vertical wind starts
 rayleigh_coeff              =                         5.0        ! Rayleigh damping coefficient
 divdamp_order               =                         24         ! order of divergence damping 
 divdamp_type                =                         32         ! type of divergence damping
 divdamp_fac                 =                          0.004     ! scaling factor for divergence damping
 igradp_method               =                          3         ! discretization of horizontal pressure gradient
 l_zdiffu_t                  =                      .TRUE.        ! specifies computation of Smagorinsky temperature diffusion
 thslp_zdiffu                =                          0.02      ! slope threshold (temperature diffusion)
 thhgtd_zdiffu               =                        125.0       ! threshold of height difference (temperature diffusion)
 htop_moist_proc             =                      22500.0       ! max. height for moist physics
 hbot_qvsubstep              =                      22500.0       ! height above which QV is advected with substepping scheme
/

! sleve_nml: vertical level specification -------------------------------------
&sleve_nml
 min_lay_thckn               =                         20.0       ! layer thickness of lowermost layer
 stretch_fac                 =                          0.65      ! stretching factor to vary distribution of model levels
 decay_scale_1               =                       4000.0       ! decay scale of large-scale topography component
 decay_scale_2               =                       2500.0       ! decay scale of small-scale topography component
 decay_exp                   =                          1.2       ! exponent of decay function
 flat_height                 =                      16000.0       ! height above which the coordinate surfaces are flat
 itype_laydistr              =                          1         ! Type of analytical function to specify the distr. of vert. coords
 top_height                  =                      22000.0       ! height of model top
/

! dynamics_nml: dynamical core -----------------------------------------------
&dynamics_nml
 iequations                  =                          3         ! type of equations and prognostic variables
 divavg_cntrwgt              =                          0.50      ! weight of central cell for divergence averaging
 lcoriolis                   =                      .TRUE.        ! Coriolis force
/

! transport_nml: tracer transport ---------------------------------------------
&transport_nml
 ivadv_tracer                =           3, 3, 3, 3, 3, 3         ! tracer specific method to compute vertical advection
 itype_hlimit                =           3, 4, 4, 4, 4, 4         ! type of limiter for horizontal transport
 ihadv_tracer                =          52, 2, 2, 2, 2, 3         ! tracer specific method to compute horizontal advection
 llsq_svd                    =                      .TRUE.        ! use QR decomposition for least squares design matrix
 beta_fct                    =                         1.005      ! limiter: boost factor for range of permissible values
/

! diffusion_nml: horizontal (numerical) diffusion ----------------------------
&diffusion_nml
 lhdiff_vn                   =                      .TRUE.        ! diffusion on the horizontal wind field
 lhdiff_temp                 =                      .TRUE.        ! diffusion on the temperature field
 hdiff_order                 =                          5         ! order of nabla operator for diffusion
 itype_vn_diffu              =                          1         ! reconstruction method used for Smagorinsky diffusion
 itype_t_diffu               =                          2         ! discretization of temperature diffusion
 hdiff_efdt_ratio            =                         24.0       ! ratio of e-folding time to time step 
 hdiff_smag_fac              =                          0.025     ! scaling factor for Smagorinsky diffusion
/

! interpol_nml: settings for internal interpolation methods ------------------
&interpol_nml
 nudge_zone_width            =                         10         ! Total width (in units of cell rows) for lateral boundary nudging zone
 nudge_max_coeff             =                          0.075     ! Maximum relaxation coefficient for lateral boundary nudging
 lsq_high_ord                =                          3         ! least squares polynomial order
 support_baryctr_intp        =                       .FALSE.   !.TRUE.       ! .TRUE.: barycentric interpolation support for output
/

! gridref_nml: grid refinement settings --------------------------------------
&gridref_nml
 denom_diffu_v               =                        150.        ! denominator for lateral boundary diffusion of velocity
/

! extpar_nml: external data --------------------------------------------------
&extpar_nml
 itopo                       =                          1         ! topography (0:analytical)
 itype_lwemiss               =                          2         ! requires updated extpar data
 itype_vegetation_cycle      =                          1         ! specifics for annual cycle of LAI
 extpar_filename             =      'extpar_DOM<idom>.nc'         ! filename of external parameter input file
 n_iter_smooth_topo          =                          1         ! iterations of topography smoother
 heightdiff_threshold        =                       2250.        ! threshold above which additional nabla2 diffuion is applied
 hgtdiff_max_smooth_topo     =                        750.        ! see Namelist doc
 read_nc_via_cdi             =                       .TRUE.       ! read NetCDF input data via CDI library
/

&output_nml
 ! ----------------------------------------------- !
 ! ---  ICON-LAM: output fields - lat/lon grid --- !
 ! ----------------------------------------------- !
 filetype             = 4                         ! output format: 2=GRIB2, 4=NETCDFv2
 dom                  = 1                         ! write lam domain
 output_time_unit     = 1                         ! 1: seconds
 output_bounds        = 0., 10000000., 3600.      ! start, end, increment [s]
 steps_per_file       = 1
 mode                 = 1                         ! 1: forecast mode (relative t-axis), 2: climate mode (absolute t-axis)
 include_last         = .true.
 filename_format      = 'DOM<physdom>_<levtype>_<datetime2>'
 ml_varlist           = 'pres_sfc', 'rh_2m', 't_2m', 'tqv_dia', 'tqc_dia', 'gust10', 'tot_prec', 'tot_prec_rate', 'asodird_s', 'cape', 'alhfl_s', 'ashfl_s'
 remap                = 1                         ! 0: icon grid, 1: lat-lon
 reg_lon_def          = 1.0, 0.05, 16.6
 reg_lat_def          = 44.1, 0.05, 57.5
/
! comin_nml: comin plugins --------------------------------------------------
&comin_nml
 plugin_list(1)%name           = "high_prec_detector"
 plugin_list(1)%plugin_library = "/work/bk1414/summerschool/icon/build/externals/comin/build/plugins/python_adapter/libpython_adapter.so"
 plugin_list(1)%options        = "../../detectors/high_prec/high_prec_detector.py"
/                                                                                                                                                                                                                                                            
